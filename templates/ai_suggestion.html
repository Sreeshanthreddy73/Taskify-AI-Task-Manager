{% extends "layout.html" %}
{% block content %}

<h2 class="mb-4">
    <i class="bi bi-lightbulb"></i> AI Task Suggestions
</h2>

<a href="/" class="btn btn-secondary mb-3">
    <i class="bi bi-arrow-left"></i> Back
</a>

<!-- PROJECT DESCRIPTION FORM -->
<form method="POST" class="card p-4 shadow-sm mb-4">
    <label class="form-label fw-semibold">
        Describe your project
    </label>

    <textarea
        name="project_desc"
        class="form-control"
        rows="3"
        placeholder="Example: A system to manage college projects..."
        required
    >{{ project_desc if project_desc else '' }}</textarea>

    <button class="btn btn-warning mt-3">
        <i class="bi bi-robot"></i> Generate Tasks
    </button>
</form>

{% if error %}
<div class="alert alert-danger">
    {{ error }}
</div>
{% endif %}

<!-- AI TASK RESULTS -->
{% if suggestions %}
<div class="card p-4 shadow-sm">
    <h5 class="mb-3">
        <i class="bi bi-list-check"></i> AI Suggested Tasks
    </h5>

    <ul class="list-group">
        {% for s in suggestions %}
        <li class="list-group-item">
            <div class="fw-semibold mb-2">{{ s }}</div>

            <!-- ASSIGN TO TEAM MEMBER -->
            <form action="/add-suggestion" method="POST" class="d-flex gap-2">
                <input type="hidden" name="task_text" value="{{ s }}">

                <select name="assigned_to" class="form-select form-select-sm" required>
                    <option value="">Assign to member</option>
                    {% for m in members %}
                        <option value="{{ m.id }}">{{ m.display_name }}</option>
                    {% endfor %}
                </select>

                <button class="btn btn-success btn-sm">
                    <i class="bi bi-plus-circle"></i> Add Task
                </button>
            </form>
        </li>
        {% endfor %}
    </ul>
</div>
{% endif %}

{% endblock %}
